QuickHash extension
===================

.. articleMetaData::
   :Where: London, UK
   :Date: 2011-07-19 09:17 Europe/London
   :Tags: blog, php, extensions, opensource
   :Short: quickhash

Back in March last year, when I mentioned that I am available for `PHP
extension writing`_, I also mentioned that I was working on the QuickHash_
extension. Now, more than a year later I've finally managed to find some time
to publicly release it. The extension also moved from my personal SVN
repository to github_.

The QuickHash extension implements four classes with each containing a
different data structure. The main idea is that keeping the data structures
internally in the objects instead of in PHP increases performance and
decreases memory usage.

The simplest data structure is implemented in the QuickHashIntSet_ class. It
implements a set of 32-bit unsigned integers.  Like every set, the class has
methods for adding__ and deleting__ integers; and checking__ whether an
integer is part of the set. Additionally, each class also implements
serializing from/to a string as well as a file.

If we would implement the IntSet functionality in pure PHP with the use of
PHP's arrays, the operations are pretty much like::

	<?php
	class PHPIntSet
	{
		var $elements = array();

		function add( $key )
		{
			$this->elements[$key] = true;
		}

		function delete( $key )
		{
			unset( $this->elements[$key] );
		}

		function exists( $key )
		{
			return array_key_exists( $this->elements[$key] );
		}
	}
	?>

To measure performance, I wrote two PHP scripts to add 2 million items. Once
without QuickHash::

	<?php
	$a = array();
	for ($i = 0; $i < 2 * 1000 * 1000; $i++)
	{
		$a[$i] = true;
	}
	?>

and once with QuickHash::

	<?php
	$a = new QuickHashIntSet(2000000);
	for ($i = 0; $i < 2 * 1000 * 1000; $i++)
	{
		$a->add($i);
	}
	?>

.. _QuickHashIntSet: http://docs.php.net/manual/en/class.quickhashintset.php
__ http://docs.php.net/manual/en/quickhashintset.add.php
__ http://docs.php.net/manual/en/quickhashintset.delete.php
__ http://docs.php.net/manual/en/quickhashintset.exists.php


.. _`PHP extension writing`: /available-for-php-extension-writing.html
.. _`github`: https://github.com/derickr/quickhash

